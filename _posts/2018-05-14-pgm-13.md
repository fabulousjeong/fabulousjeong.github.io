---
title: 13 Plate Models
category: ProbabilisticGraphicalModels
excerpt: |
  동일한 유형의 객체가 여러개 있는 경우 일반적인 반복구조로 표현 할 수 있습니다. 사실 이러한 객체는 완전한 복사본은 아니지만 비슷 하거나, 같은 확률모델을 가지고 있습니다.


feature_text: |
  ## [Coursera] Probabilistic Graphical Models
  Daphne Koller의 Probabilistic Graphical Models 강의 정리

  ref: [https://www.coursera.org/learn/probabilistic-graphical-models/home](https://www.coursera.org/learn/probabilistic-graphical-models/home "coursera")

feature_image: "http://netascholars.org/wp-content/uploads/imgs/index.php?w=700&src=http://netascholars.org/wp-content/uploads/2013/04/9780262258357-1024x512.jpg"
image: "http://netascholars.org/wp-content/uploads/imgs/index.php?w=700&src=http://netascholars.org/wp-content/uploads/2013/04/9780262258357-1024x512.jpg"
comment: true
---


##### Plate Models

![](http://cfile28.uf.tistory.com/image/266B5B4858A305BC3370B6 " Plate Models" "width:600px;height:250px;float:center;padding-left:10px;")

동일한 유형의 객체가 여러개 있는 경우 일반적인 반복구조로 표현 할 수 있습니다. 사실 이러한 객체는 완전한 복사본은 아니지만 비슷 하거나, 같은 확률모델을 가지고 있습니다. 이번 시간에는 그러한 모델중 가장 일반적인 플레이트 모델(plate model)에 대해 알아 보겠습니다. 간단한 반복 모델부터 보겠습니다. 반복해서 동전을 던진다고 상상해 봅시다. outcome 변수를 가지고 있으며 던지는 행위를 반복합니다. 이러한 반복을 나타내기 위해 이 변수를 plate라 부르는 박스안에 넣습니다. 이제 outcome 변수는 인덱싱되었습니다. 이제 여러시행에 대해 개별적으로 표현하지 않아도 됩니다. $t_1,...,t_k$까지의 동전이 있다고 할 때,  왼쪽 그림은 오른쪽 그림의 그래프를 여러번 시행하는 것과 동일한 의미를 지닙니다. CPD의 매개 변수 $\theta$를 노드와 연결시킬수 있습니다. 여기서는 동전의 앞면이 나올 확률과 연관된 변수일 것입니다. 이러한 매개변수는 플레이트 밖에 위치하며, 각 노드에 동일하게 작용합니다. 즉 t에 의해 인덱싱되지 않았으며, $t_1,...,t_k$에 대해 각각 독립적으로 적용됩니다.

![](http://cfile3.uf.tistory.com/image/230E4D4858A305BD227EB6 " Plate Models" "width:600px;height:250px;float:center;padding-left:10px;")

조금 더 흥미로운 예를 보겠습니다. 위 그래프는 학생의 지능과 성적에대한 두 변수가 있는 모델입니다. 이 모델 역시 여러 학생들 s에 대해 인덱싱 할 수 있습니다. 즉 왼쪽 템플릿 모델을 오른쪽과 같이 복사해서 반복적으로 표현할 수 있습니다. 이 경우 학생 1, 2에 대해 2개만 만들었습니다.  이 경우 역시 각 변수에 대해 CPD 매개 변수 $\theta_I, \theta_G$가 있습니다. 이제 서로 다른 플레이트를 겹치는 경우를 살펴보겠습니다. 

![](http://cfile30.uf.tistory.com/image/2469624858A305BE3257FA " Nested" "width:600px;height:300px;float:center;padding-left:10px;")

이제 수업의 난이도(difficulty) 변수가 추가되었습니다. 이 변수는 과목의 난이도를 표현하므로 각 과목(Course)플레이트에 속할 것입니다. 그렇다면 학생 플레이트를 어디에 넣을지 정하겠습니다. 일단 코스 플레이트 내부(nest)에 위치시켜 보겠습니다. 이 경우 학생의 지능을 나타내는 변수 I는 c,s 두 플레이트에 의해 인덱싱됩니다. 위 플레이트 모델을 과목 $c_1, c_2$와 학생 $s_1, s_2$에 대해 풀어 보겠습니다. D는 c파라미터를 가지고 있으며, I와 G는 s,c파라미터를 가지고 있습니다. 그런데 위 모델을 보면 학생의 지능이 과목에 영향을 받는 것을 볼 수 있습니다. 즉 수학이나, 예술등 과목에 따라 학생의 지능이 달라집니다. 같은 학생이라고 하더라도 과목에 따라 지능(적성)이 달라집니다. 이는 맞는 모델링일 수도 있으나 학생이 비슷한 과목들을 수강한다면 각 과목에 대해 영향을 받지 않을 수도 있을 것습니다.   

![](http://cfile9.uf.tistory.com/image/232DAA4858A305BE3AFC2B " Overlapping" "width:600px;height:300px;float:center;padding-left:10px;")

어러한 경우 위와 같이 플레이트를 중첩(overlap)시켜서 표현 할 수 있습니다. 이제 학생의 지능은 더 이상 과목에 영향을 받지 않습니다. 지능은 오로지 학생 s에 의해 결정 됩니다. 중첩된 영역에 있는 성적 변수만이 과목과 학생에 의해 인덱싱 됩니다. 이제 학생 당 하나의 지능만 가지고 있습니다. 이는 한 현상을 표현하기 위한 하나의 다른 방법이며, 어느 것이 옳다고 단정 짓지는 못합니다. 각 현상에 따라 적절한 방법으로 모델링 해야합니다.    

![](http://cfile3.uf.tistory.com/image/2765CF4858A305BF33F768 "Explicit Parameter Sharing" "width:600px;height:300px;float:center;padding-left:10px;")

앞에서 살펴 봤듯이 각 플레이트 외부에는 각 변수에 대한 CPD를 결정하는 매개변수 $\theta$가 있습니다. 이를 추가하여 위와 같이 표현할 수 있습니다.  

##### collective inference

![](http://cfile23.uf.tistory.com/image/257C5A4C58A443401FF425 "collective inference" "width:600px;height:300px;float:center;padding-left:10px;")

이러한 플레이트 모델의 유용성을 보기위해 여러 변수가 있는 모델을 살펴 보겠습니다. 신입생 철수가 수업을 듣는다고 상상해 봅시다. 이 때 학생들 중 80%는 똑똑하다고 CPD를 설정합니다. 우선 학생은 Geo101 수업에서 A를 받았습니다. 따라서 그 학생이 똑똑할 확률은 올라갈 것입니다. 반면 CS101수업은 C를 받았습니다. 이제 철수의 지능이 높을 확률은 조금 떨어 질 것입니다. 하지만 매우 많이 떨어지지는 않습니다. 애초에 80%는 지능이 높다고 CPD를 설정했기 때문입니다. 아마 수업이 어려웠을 수도 있고 모든 학생이 안 좋은 점수를 받았을 수도 있습니다. 철수가 들은 두 수업만을 가지고 추론했기 때문에 더 자세한 추정을 하는데 한계가 있습니다. 이제 더 많은 학생과 수업을 이용하여 전체론적 추론(collective inference)를 수행해 보겠습니다.     

![](http://cfile26.uf.tistory.com/image/245C7E4C58A443412185C2 "collective inference" "width:600px;height:350px;float:center;padding-left:10px;")

이제 모든 학생에 대한 성적을 가지고 있다고 가정해 보겠습니다. 위 선은 학생의 성적을 나타냅니다. 녹색선은 A, 노란선은 B, 빨간선은 C성적을 나타냅니다. 위의 CS101 수업의 경우를 보면 다른 많은 학생들은 A를 받은 것을 볼 수 있습니다. 철수만 C를 받았습니다. 따라서 전체론적 관점에서 수업 CS101은 쉬운 과목이라 볼 수 있습니다. 그리고 만약 CS101이 쉬운 과목이라면 철수의 지능이 높을 확률은 더 떨어 질 것입니다. 따라서 풍부한 변수를 사용한 전체론적 추론을 통해 한 변수에 대해 더 나은 추론을 가능하게 합니다. 나중에 배울 이미지나, 웹페이지에 대한 전체론적 추론에 비하면, 위 예는 매우 간단한 모델을 표현하고 있습니다. 하지만 풍부한 변수들이 어떻게 관련 되어있는지를 통해 더 많은 정보를 얻을 수 있으며 이를 통해 더 나은 추론을 할 수 있다는 것을 보여줍니다. 

![](http://cfile3.uf.tistory.com/image/2560034C58A44343213307 "plate dependency model" "width:600px;height:350px;float:center;padding-left:10px;")

플레이트 종속 모델에 대해 알아보겠습니다. 이것은 여러 객체 유형에 대해 인덱싱 된 템플릿 변수로 부터 종속성 모델을 정의 합니다. 가령 학생이나 과목에 대한 템플릿 변수가 있습니다. 또한 템플릿 부모 변수도 가지고 있습니다. 학생 모델에서 학생의 성적 G는 템플릿변수(A)에 해당됩니다. I, D는 부모 변수(B)에 해당 될 것입니다. 학생 s와 과목 c는 인덱스 $U_1, U_2$에 해당 될 것입니다. 그리고 위 그래프를 보면 자식 노드는 부모노드의 인덱스를 포함하고 있습니다. 즉 부모노드는 자식노드에 없는 인덱스는 가질 수 없습니다.  가령 성적의 자식 노드로 honor과 같은 변수가 있을때 이 노드는 학생 인덱스만을 포함 할 수는 없습니다. 플레이트 종속 모델은 유한한 부모노드를 사용하여 자식노드의 CPD를 정의 할 수 있습니다. 이러한 방법은 여러 인덱스에 대해 동일한 방법으로 재사용 할 수 있습니다.           

![](http://cfile24.uf.tistory.com/image/232B4F4C58A4434333F4B6 "ground network" "width:600px;height:250px;float:center;padding-left:10px;")

플레이트 종속 모델은 위와 같이 그래프로 표현됩니다. 그리고 앞에서 설명한 특성에 의해 A의 인덱스 $u_1,...,u_k$는 부모 변수B 셋의 인덱스들($U_1,...,U_m$)에 대해 대응 될것입니다.  

![](http://cfile24.uf.tistory.com/image/2732534C58A443442534BD "dependency model" "width:600px;height:250px;float:center;padding-left:10px;")

이를 식으로 표현하면 위와 같습니다. 즉 부모노드에 없는 인덱스는 자식 노드에도 없습니다. 앞서 plate가 겹쳐져 있는 그림을 떠올려 보면 이해하기가 쉽습니다. 

![](http://cfile24.uf.tistory.com/image/2732534C58A443442534BD "summary" "width:600px;height:250px;float:center;padding-left:10px;")

플레이트 종속 모델을 사용해서 무한대의 베이지안 네트워크를 표현 할 수 있습니다. 모든 변수가 템플릿으로 주어지기 때문에 인덱스의 수를 조절하는 것으로 무제한으로 베이지안 네트워크를 만들 수 있습니다. 그리고 파라미터와 그래프 구조는 재사용 됩니다. 그리고 인덱스를 늘려 많은 변수를 사용할 수 있으며, 이를 통해 전체론적 추론을 가능하게 합니다. 플레이트 모델은 템플릿 구조를 표현하는 가장 간단한 표현법(language)입니다. 따라서 모든 현상을 표현 할 수는 없습니다. 앞서 살펴 본 연속 된 시간에 대한 모델링에서는 자식 노드에만 시간 t를 인덱싱하는 경우도 있었습니다. 이러한 경우에는 사용할 수 없을 것입니다. 하지만 다른 표현법을 통해 확장함으로써 표현 할 수 있을 것입니다. 이러한 모델은 각각 장단점이 있을 것입니다. 그리고 이 강의에서 모두 다루지는 않지만 유용한 표현법이 많이 있습니다.      





